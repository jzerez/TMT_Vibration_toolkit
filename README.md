# TMT_Vibration_toolkit

If you're reading this in a default text editor (if you can see a hashtag in front of the first line), please use a markdown interpreter to view this document, it'll be worth it. [Try to view on Github](https://github.com/TMTSystemsEngineering/Jonathan)

Tools to assist vibration measurement and analysis for the Thirty Meter Telescope project. These files were generated by Jonathan Zerez in the summer of 2019 under the Akamai Program. There was a lot of development done over the course of the Summer, but the main deliverable of this project is a GUI in MATLAB that interfaces with NI-DAQ hardware and provides functionality for impact hammer testing. This tool was created in order to expedite the vibration testing process in order to collect physical data more efficiently. This data needs to be collected in order to validate Finite Element Models which were used in the generation of the Vibration Budget.

Once developed, I tried to validate the tool by collecting data on simple systems- homogenous masses suspended by a long cable. The cable acts as a weak spring in 2 axes, helping to isolate the article from external vibration. I compared the inverse mass transfer function produced by the tool to the article's actual inverse mass to at least crudely validate the tool.

Once validated, I collected testing data on the MSIT structure in the lab in Monrovia. These datasets and documentation of their setups can be found in the _./RAW/Summer 2019 Datasets/_ directory.

For more background about this project, see the following [Project Presentation.](https://docs.google.com/presentation/d/1hwgThiWFmW9H4tubOF0HxQ6D3k3vMYS_dwNmzaI2lx8/edit?usp=sharing "Final Akamai Presentation") (Local Power point can be found in _./Akamai Documentation_)

For a more formal overview of the project, see the [Project Abstract] (https://github.com/TMTSystemsEngineering/Jonathan/blob/master/Akamai%20Documentation/Jonathan%20Zerez%20Final%20Mentor%20Approved%20Abstract.pdf). This abstract can be locally found in _./Akamai Documentation_

There are other minor files and scripts developed over the summer, most notably, a tool to combine data stored in .TXT files produced by Peter Byrnes' Labview data collection software, and convert it into the .MAT format, allowing for easier processing in MATLAB.

## File/Directory Descriptions
The following is a guide to what files and be found in each folder, and the functionalities they contain

### _./Akamai Documentation_
Contains documentation produced for the folks at Akamai: Project abstract and final project presentation.

### _./MATLAB Scripts_
All of the MATLAB code written for this project
* **_./MATLAB Scripts/Hammer Testing GUI_**
  * The Hammer testing GUI and associated data acquisition configurations
  * One can open the app by simply double clicking it, and edit it by typing `appdesigner('hammer_test.mlapp')` into MATLAB's command prompt
* **_./MATLAB Scripts/Labview TXT to MAT scripts_**
  * The main script is contained within `vibration_tools.m`. Open and see in-line commenting documentation for implementation details
  * `vib_plotting.m` simply plots the output from `vibration_tools.m` to original data to help to ensure that the correct operations on the data were performed. Open and see in-line commenting documentation for implementation details
* **_./MATLAB Scripts/Misc_**
  * `Chirp_tool.m` is a function that generates a chrip signal
  * `attitude_correction.m` is a script that tries to align the accelerometer axes with gravity
* **_./MATLAB Scripts/Old DAQ GUI Files_**
  * These files are the GUI files originally created by Hugh Thompson using MATLAB's GUIDE platform. They contain some edits made by Jonathan Zerez, most notably, the ability to enable triggering for data collection

### _./MSIT Ansys_
Contains Ansys Files for the MSIT. See _./MSIT Ansys/README.md_ for more details

### _./Plots_
Various plots generated by the hammer testing GUI. None of these are essential and can be relatively easily regenerated

### _./RAW_
Contains data collected from accelerometers in datasets
* **_./RAW/Old datasets_**  
  * Contains datasets collected by Peter Byrnes and Hugh Thompson in the past. One can use `vibration_tools.m` to convert these to .MAT files
* **_./RAW/Phone testing data_**
  * I collected data from my phone's accelerometer while it was suspended by a cable. These are those datasets
* **_./RAW/Summer 2019 Datasets_**
  * Contains the datasets for each test I performed
  * _./RAW/Summer 2019 Datasets/Background Datasets/_
    * Contains datasets of accelerometers measuring background vibrations on the MSIT
  * _./RAW/Summer 2019 Datasets/Misc (useless) Datasets_
    * These datasets were collected by measuring the acceleration from a laptop playing a chirp signal. They aren't very useful because the laptop was not isolated. This directory could probably be deleted.
  * _./RAW/Summer 2019 Datasets/Validation datasets_
    * Contains datasets of accelerometers from validation testing
  * _./RAW/Summer 2019 Datasets/+MSIT_X#-Y#_
    * Contains datasets for each test from the MSIT. `X#` refers to the location of the hammer strike and first accelerometer (based on previously labeled nodes/components of the MSIT). `Y#` refers to the location of the second accelerometer, using the same node/component naming convention
  * **Notable datasets worthy of further examination**
    * *./RAW/Summer 2019 Datasets/+MSIT_T15-T16* contains testing datasets that I collected with Doug MacMartin
    * *./RAW/Summer 2019 Datasets/+MSIT_BB2-B9* contains testing datasets that I collected exciting the center of a top chord

**Note on Dataset naming nomenclature:**
Each dataset collected from the MSIT will have the same naming convention:
`MSIT_X#-Y#_COLOR_D#.mat`

|  | _MSIT_ | X# | Y# | COLOR | D# | _.mat_|
|:----:|:----:|:----:|:----:|:----:|:----:|:----:|
|**Description**| - | Input location | Output location | Hammer tip color | Direction of Force input (see accelerometer channel names)| - |
|**Example**| - | BB9 | T15 | RED | Z1 | - |

The output and input naming convention is from the MSITs pre-existing naming scheme for each and every node and component. X/Y is/are letter(s), # is any number. Color can be RED, GREEN, ORANGE, or BLACK.

### _./References_
Contains documentation for external resources that were helpful for this project

### ./change log.txt
Contains roughly constant updates for the project day by day

### ./MSIT Fixture.SLDPRT
A CAD model for the MSIT. Contains the locations of the grounding U-bolts from the Lab.

## Shortcommings and Future Steps
* Damping estimation is not accurate at all and is basically worthless. Do **not** trust any number that it spits out.
* To change the tool to work with *any* data acquisition (not just hammer testing), try each step in order:
  1. Remove assertion checking for the existence of at least one hammer channel
  2. Add `if` statements to the `parseData()` function in `hammer_test.mlapp` to prevent functions that take hammer data as arguments from evaluating. Make sure to assign `[]` as the values for the fields of the `parsedData` struct that would have values if the functions were allowed to evaluate (Ex: `parsedData.ImpactMags = [];` )
  3. Add `if` statements to the `plotData()` function in `hammer_test.mlapp` to prevent plotting datasets that don't actually have corresponding data
  4. ???
  5. If nothing else works, just trick the UI into thinking that there is a hammer channel, and only look at the accelerometer PSD graphs. Crude, but it'll work.

## Additional Thoughts and Conclusions
### MSIT Testing
* Collecting and in some part, analyzing data with Doug MacMartin, it was possible to start to identify a few rudimentary modes of the structure. The data behind these conclusions can be found in *./RAW/Summer 2019 Datasets/+MSIT_T15-T16*. Predicted modes of the MSIT from ANSYS can be found in *./MSIT Ansys/Modal Frequencies.txt*. Below are notable frequencies
  * 12.8Hz
    * First mode of the structure. Reasonably comparable to predictions from ANSYS. Has good coherence and appears in multiple datasets (hammer impulses in X, Y, and Z)
    * Might be 2 modes packed close to each other
  * 14.2Hz
    * Second set of modes of the structure. Has good coherence and appears in multiple datasets
    * May be 1-3 different modes packed close to each other
  * 20.8Hz
    * This mode is very very strong, but only in the Z direction. Doesn't have great coherence
  * 24.4Hz
    * This mode is displayed to some degree by every channel. It also has good coherence
  * 37.6Hz
    * Very very low damping for this frequency. Possible mode of the MSIT, has good coherence

### Implementation
Possible pain points
* Occasionally, it will refuse to move data from the current acquisition to the cumulative average. You just need to let go of this information and collect again.
* Impact Peak limit functionality needs to be tested (not tested because of limited access to DAQ Hardware)
* Cumulative plotting in the 'Latest Acquisition' needs to be tested (not tested because of limited access to DAQ Hardware)
* Most of the time, errors are inconsequential and can be ignored
* Yes, I know I spelled 'cumulative' wrong in the vast majority of the code...
